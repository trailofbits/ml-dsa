package mldsa44_test

import (
	"encoding/hex"
	"strings"
	"testing"

	"github.com/stretchr/testify/assert"
	"trailofbits.com/ml-dsa/mldsa/mldsa44"
)

// This test only covers some internal calculations from an all-zero seed
func TestKeyGenZeroSeed(t *testing.T) {
	seed, err := hex.DecodeString("0000000000000000000000000000000000000000000000000000000000000000")
	if err != nil {
		panic(err)
	}
	var seed_copy [32]byte
	copy(seed_copy[:], seed[0:32])
	sk, _ := mldsa44.KeyGenInternal(seed_copy)
	expand_sk := sk.ExpandedBytesForTesting()
	expect := []byte{186, 113, 249, 246, 78, 17, 186, 235, 88, 250, 156, 111, 187, 110, 20, 230, 31, 24, 100, 61, 171, 73, 91, 71, 83, 154, 145, 102, 202, 1, 152, 19}
	assert.Equal(t, expect, expand_sk[0:32])
	expect = []byte{197, 193, 97, 10, 64, 119, 79, 14, 186, 51, 52, 248, 181, 190, 86, 232, 120, 113, 179, 195, 167, 114, 192, 114, 15, 163, 118, 102, 174, 23, 53, 253}
	assert.Equal(t, expect, expand_sk[32:64])

	// Check TR
	expect = []byte{230, 188, 56, 161, 195, 95, 140, 240, 142, 68, 9, 36, 201, 3, 113, 151, 187, 135, 253, 196, 100, 107, 134, 218, 90, 5, 137, 163, 38, 204, 12, 13, 149, 15, 248, 181, 169, 234, 65, 53, 234, 184, 169, 63, 128, 240, 146, 126, 18, 64, 70, 226, 91, 35, 102, 174, 162, 90, 109, 29, 15, 239, 152, 33}
	assert.Equal(t, expect, expand_sk[64:128])
}

// Test key generation
func TestKeyGen(t *testing.T) {
	seed, err := hex.DecodeString("4BE7A01A99A5E5BCFE3C06785D8E4EC664082227D86704E9E44862623A05C8B3")
	if err != nil {
		panic(err)
	}
	expect_pk := "ADB0B33464816091F2A95977C67F085FDC24B37854D4DB0A577AE9401E408148D8917D21AA496BB13C60B295CB0A942322A039979828F46A00A4E7DEEBA2BC065216D97D93FD6BC1CD87DD383F18963CE5CFDD71B51DF08086F1415EA512AFAE38CE16E517142D3AE3EDD39496705679466AA9CC3FFA14071DC56244FD1CA4ECA5A1405D5F1FC12F3C5ECACC4B9B021BCA7201C4EA0D670099B7BBD50707164F3F395569990BC6E7E30424B37AB0621DB2954E5996B15670DC4CE03A1497E40465A4C326F1E065E2BFDF1A11ADBA1193522788EEA006B8B1AB296AE1B174C956AE9555180274294CDC19CB4EEFF2AAE1260AB1E03C7CCF8D8A6DF42BA67EEA3228E9E8319821FB06538C71061B5E1D79274816152A4F188FE39743D86ADED0D4E9020D5DBA0596521E8E6A2D50811E6E989AE0D35B4D400A4A4C5C883132F6F3DBD3F6517ECB27745924897FC1141CBFEC4CDD4E871E2D302AE95643D382CAEEF0DED3F1F0646768AB18297EEEC4796CF8A5964F21D55B7B3C1117843B1FAE74D8496302181EE682D076E7858B13BE612EDBB2635FFD51F3964140890F1015C32E3FFBDFB0C76E163169122B35F91E1E29C5B9C92DC40DC738FB7AA44932B937CAFA03EDD7E711EEB19A828034EC3981A2950383F6C6F734BCFFE68D39B71D7F55FE35E4E2299C0A9EDC40B66DB41F7BCA341162DE0350B54E720B9A1AAE0D99DB0A58D052B69EE1A30227439BDFD8C1D4FDBEB4691F9CBD5BB62B47CB0E782BF310E2787B3C255B67708C5C7C751F48BB797069C290493BB8561072EA17B145D26B07209E292FA5ED76CAA31B2D7DB45DDB096D44CDA13ECD03E3547B521DC30CE27D66A288B4059701598D0AD38A33130EBC492BA025D93C58E8BD11873B37ADB1B39066FE83EAD645AE6B04F758470C163AD96AEDA9208420C6E9C274EFBB853563E1CB3660D275F85BB551A2888A1EF05AAF321F65D4EB15DADC93C76A4B52D0C34F556592824968200EBDE652740727E0CB0A6DE0280FCD82CD496A1F5BAF95657BA3C1091FCC36BF7EBE77FC34889EA438A07E92ACEAE453C8EED93D9A70E82CA3B8D06EC9EADB5EAF8B491B665B3903B8C8613A2407A6E5F35F44678B1935663BBA7561096C2E3D502EF0F7A245A52252280016C0B74E3B05D93AEA24CAEBA4D595C31434D99B46F5B5EF4D3A3A625EDD7EB95DCD27C828949699C5E567D7A8512619E14ECC6E1C47CA6567211D1211FC6B949B83783C7CB41762167BF960E935FD853E9ED3BBECCB75E8DFB4E35F854566DCDB300EB0D51B6C22E6EB1D85030DAA5A2FE2BBCC7C2745790860AD48033DA038421051D161739F524BB1C716250623A57F64CB2506DF49C66537C2A46CD0A68D0017BB33CBA4CF37351291D208033768C86799E016A960E6824670FBFF1061087DA8FB74F977110239DED48CFC86A4FC4BAEF220F05AEB0CE34357D7D31D20388FAA307F2D97F593B9E287322A9C329E04328522EA79AAC31CF2765FB334ABD9A1764DA3550968FA693CB84852268170022881CC388745A54A500FACB2B8DF36383E219B99177C3AF51B1E33AF783EFEAE04A0F9845D79AA4A4DD9DDE5CAF7D52D779D59D18F0E0E2B44B634A5D630BE8198AD8B2012C52A7B89F133F09C3E8D21F0AD1137AF095893B966FFC07E8956585FF5C10B123C6A4A5C3367D898ACB128915FE710DF75FA23B4005CAFFEE518C1420403523F0D7EB03696BD21282EB0B1C18A68F70F66837A58453190A06AD0F6E2C28C88183548C7026E2ECC8A5DC5606BBB3679F249B7A2EF79FE70441C03FE0B541016DA53AEDC40CB69A4C952CD075A89D5032380E4A1C3"
	expect_sk := "ADB0B33464816091F2A95977C67F085FDC24B37854D4DB0A577AE9401E408148CF195E6D8DD398713E8F317A5CB4D4F00B2B41F3A9588A8FA4B895D8D8D1C9A11FB72B86F9B4A75132567BE2C45E873D6B5D4A8B8C59F46F2DB81B0857144DB5416B071DF2A8F77D437D47C3BFE11F16FEEFE6C470F46762C881AD19C0884BB3024426889869134586D3B041D3284660C22818230254285203810D04875020262284128E1C462A20034548382911901080405019B385084848CC049004886089A48922050A19876851322AA0044154224EE34029044110021370DBA269E11872C4362619026622960D988425C1026E24233140B8708A18091C10684C120209B72859840C01864DC04262DA846D0926708C166EE24425513868C28425083991908804A3466603110202C864024924509229209581E448618C4808E3182D1CB82942A26C14A2454810710B15442248845842201897690AB530D3300CDC202C61360214338EE4882413B04401062813324C13354DC9A88DD0322D0A11720A2450C280490AA71023236EDBB441C8966C49442118102009286964180918376CC0126EA2808C0B15804BB66C14B24143A0845C385003028EA1C80D1A120E9A208400330190A20508150002A211904806190408C398911CB8008A4265E2484001A0016222841B322808382409456E033511149580A12051513472039205613271C14402C4009009158E48A08800B87152B02902282E5296891A210D11A22D6426718C0012C02662E0301198364461C24C04306CE0184E0CC2259A3022E48824D2C860CAB88C12460464366E18C82D5B34898A226A11B03013848104113162B409E4222C4B202D0A0370DAC261E1308A9C968803456E41240D5C04004C324AE0124A1C250A84364890982CC2B444C34852CB960854342823252624B951183770E2C86418C628C0428DD9A608A3300E00B461CAC2004A3224CCC42CD1244614108209B20989322854126658C869C22649609601D9346010C05159442C81C26903008D9BC64064402ED8440AE31425D3423243224609A2699424888AC48D0441115B94111C3386A4A4611AB54C91220E22B66422976843382EE1B41163908552C028E444295A266601062580466104A42C94045210082401050D1824261830844B042DA0B400D4B490C3084622B131144971D3346148026500A12004448511014D84C23061C28903460022B24593A02D1846480B34885CA284C8A06488A4801298211B496AD8335FA79BF4EC5FEA39F1AC7B7C5854F0FB1985F43D707F567CE12329E43ABDAA9ED4C4B39B6320CA70EBA09A1597717B72ED5B0AEFD46B7C5CBD56D81C3A7A6A9D35EF4E5B87A9FBFD9B384C6B7F43EC296372379B9705788BC7AA36688596A856C024FAB24091F1B2AD8DF64FBABAC18EFF6261A91B454896D23CEB52EF22D93F2BF6D6EC40CEE7FC8312D787AC9D45C6B2C1C52FDDEA9A40DB0AF632792E19E98E04EC442352C988AC86E1BB7D3F63A412F9C7EAB17463D116315D16074C8E6CE01320035B0A6351186F3C7E17E09137CE763AD7C7BE49541B7405BBB8C7026A5FA977BAE1B65B94869EFEF01B77CF173E469A30DA182BD7662AF04818BD623524D5600F23FD5868FA42A45F39672E401E2CF336F41322F823684E6B8799B55FB96EF92F410E23DDA77248DE659F703228F99C8ADF04523C881057344954A81FDBAE000FAE484CD896C4E6543CAE005A0E3DF51E37C0401D106E50DBA14168B5496A3D6DAAB2E010C2DCE215553D10347A9581988D9EDC2583FC10350EC5EF0518B3FA9B54702D93F2A9380697E426C2A017C1DBED6925C44A77509995FE390CABF213D013F2CB9EBD9E09F9A0949803DE285C9C2E6A02CFFE7AEAF013EAAB9B4E82E5D75BBF8E0B8474FF63B2E7BEC2F1AA54EFA0C194B68FD4924636D0E188A31E32A4265B248FC9525ED9462F9BF04B86B443BF5F86AE66647E463646D02D0D8CE201E0C2CE4A3623D0D193A6644634FEBA47A855989FCC8F3DCB81C5F05D9A0FE2E0E4DC094A621F9FF43F1F3E9A8F98CFD4E3C22F5FD7A0DC788A132E6F03427D291EF9D68AF3F3B669A765632DAC5AA38D5735CA370D4EBCA8F06F0F59D6C0D7497D951F9668B534037B027FA5A2FC46DF7AF23BE5616DB20ABACE02EA19BE4B5DE64E09A71A7F90726E38B5A968D7E51F15466DA0AAC9B74CD50C543819D0CEBE879864D1459E4808145F5F29521016BB62B05D8F717B1250CCEF8A4C0296292A8662499D94F7C3FF83D7E17D8D1418EC3F6843EBCBEBB960F9F661E456DADC4843729D3FB396D8E84EE1245672321E4D4C59454B53084439D7662042EC1BD293052E6A44461BD353CF32A4B9FD4E95434554CEA0922CF0D50B5F718DE7B2F01DE189EFB835F4B29AB62B99DC76CCBEC202A4820DF92A820313879F8AF19BFEE5B457BF2987BE486CF3E819A4FCE67E64C6ABB4DD9811A5BD82BE732743C52B1F84AF1B44145C68A96A06EDF5CFB7ADC5BEC55E60F6870BD10DFF603B10E3F454C0C97FB337B12C5DE06938F65D4653F7D1EDDD281E4DDB1B7A5E4753776985EE7215176208B51C1D0138AF1D6A53541F31295121AF682D6FC09F335B88108407AD782094A7ABC664AE1C6B981BF5D646A0CBEEAAA17B2353CAF31E4E1C726E340FF41CFC9E04BC770AB7CC2EB07F010B4298292EFEACA193347CD0BF18370474D0DCD95F5EB45E6AFD4936F8251A1B19521ED7B22679B53C331FA14850D877AA12BEBC68903F8C17C46F7547038D22CDA0D60C912FB9DCB0E4E8FB656B90C41F3820B9093826B090413185934DBC92FA2D209F96BC58B100868C24F8845CB32F2887EE5826F6B88B47E62B55E53989AF385C1DC06815A4F3E73C695694B764166456E46B4C050A61229A87B33DBA7E56CA77D852CC58BAD101085A58C55889A61C09B75BCCD42C8063C7AAC1325C9FCA8F6EE4673B0856C33AA68C0E769EBCAAC47087D62117C0F5D1CAD216FE1D6CA3C46D94C13EEFB81116E2A494324FAF223ABA503804C7368CCDFC942E1309CA8CF55E4D3F77F9A65D846A003DD79E91A36F9A86BEDA5CACF6F8A8D35826D3AB6E93D86FABAC914E84006D6238A99BDEFBFF9390A455ACD8681141B4A6EA6441E62E436CBB65BB1030ABF3C59ED142E2E22544693EB34BBF0B12EFBF01BF6560F1A559D2CA9FDB9D8C96FF421CC1CF34B4FBDC85E8BB0453DD6678ACF400C31B3B40A2D8BD8639BABC12ABF9A3365959F46B8EF06668F362C7EAFA89C6C2C525C7E9E5840B4526FD1FE9575B3A44195F5DD31792490E76E254C6131A98DD77F8D6AC749AC82A98382A4882C42AD7C63DF220DA0FBC46815A21C49F2AD143B76F789E02B6382100DEABDCCDEFC6E74B87724B9582DEEB98E2DA6F3162D2D568F373C87E7B38F858B7121952D78BB0C59A18D76032D8282215634F731C867F8ABDD12003BD4CC1DC7572785AF61535EDAD9E4F25769A40E3917B272659D1348AB8E61242ED8B97D511D57915E583671369B6088B4B4F8823F610D1B5C1578E3FF45DAB7CC47D589A680A1DE60AB9B51F1A531FBA56ED21B3B5EEEE4F7535F306D58323687E203614DC64A689"

	var seed_copy [32]byte
	copy(seed_copy[:], seed[0:32])
	sk, pk := mldsa44.KeyGenInternal(seed_copy)
	// Does the public key match?
	assert.Equal(t, expect_pk, strings.ToUpper(hex.EncodeToString(pk.Bytes())))

	// Now compare the secret key
	actual_sk := strings.ToUpper(hex.EncodeToString(sk.ExpandedBytesForTesting()))
	assert.Equal(t, expect_sk, actual_sk)
}

/*
func TestSignVerify(t *testing.T) {
	seed, err := hex.DecodeString("f696484048ec21f96cf50a56d0759c448f3779752f0383d37449690694cf7a68")
	if err != nil {
		panic(err)
	}

	var seed_copy [32]byte
	copy(seed_copy[:], seed[0:32])
	sk, pk := mldsa44.KeyGenInternal(seed_copy)
	expect_pk := ""

	assert.Equal(t, expect_pk, hex.EncodeToString(pk.Bytes()))
	message, err := hex.DecodeString("6dbbc4375136df3b07f7c70e639e223e")
	if err != nil {
		panic(err)
	}
	ctx, err := hex.DecodeString("480c658c0cb3e040bde084345cef0df7")
	if err != nil {
		panic(err)
	}
	signature, err := sk.Sign(message, ctx)
	if err != nil {
		panic(err)
	}
	expect_sig := "e7c82fca315573ef8cc7160ce95d92fa79ac21521523de0e6700768207e9b7b9fae9cbdbf8f97b06d79ed4f5ea4513086c4b065ce9296ae0cd9b133f65c314fcef6d537b1d2d7077e779be24c149d8284c82f4937b0815d656e404ad4ad87d78ddbc493c6ace7a2aab9446243f37c64d7c441212307d07a3fbe2573194c0b75ed55c398a2c633984fd397252320feffd79d892dd0ab6c9cb661e47fe8d6e76a0ff4e83abed5aea3feff912f7c5a067370ca037d88260fde55b0eb3220d44a12a39578b891ce7948db3f389b0ebda721d664e1790c40b9b8167c0d9ca03e359da4ab675ab011b0c57a7ed55cfd8c250e5b890471c1e581d3b3eb3a6f3c79223ae0e881886f4feb285442855e106070a5ef40a7a74b5e95bfd316d0fdcf464b3b2f708b2d9dcd6cc565d0b54b07e319ee413a2e430bbd855c74e9477fc06ebbdceec9c7a2ac0af875bde016c61742c62f42bbd48a3a51089b30fd5a62bf77091eda29cd722765e24ef2693bf34665cb118d9e07e846c3703461015cf1c37fdeada056ad91e67cc77139c8c27c5c6c00895a48a8f3d5bb0b3719edadb9bb666b655e218855e9d19fac78f179bf598f7de2437305691aa5b8ec57f2337a7e2d1f007d920090ebf765b98cf784f24da4f19089d1f8dfb03e5ebe676898d4067c5fc51238b2fcaccfadd4795d96899b451097d27595928d0fb0b64fb190739a51d7fe063ce0dd99a74510f080c1ef4f61cd11d9859e4ed550f6f1e4eb23f164de1d5af8f050f56eabda15e1d54766c3fbdc30f43cfd8174e3c8ca6274865ed7c7a7d1a410ab51549b5b736e0c82ed9af8241ad8a266378caa062653283e79085134b4db8917f7c8d4d8ee94b5a42aa8148b69f1f719aad9fb315a4678e91f4b4b1268d96e50921c7a68d4832ee1018bcdac84a46aa52021ea1aece7cb85ecb57bb706231df46b6f8d58f3d2880bc9b5d478af82eafb861b6a0f7e266f3ff67c3092ba326e6d827e76f5a34c52bb82c9a06a82650c9e0626c3dbe1a0a748bf89bc14dfde33185b063a9247c5997e2e08e8404abc18cfdf7d2fd8870eb8d964fdd97c3325be0bbb1a76ec220aa68b400ece8e95abcd94edc0173398d2f6badd23e33b27bf28276d7657681d7e5fc9f1b7414aab0f45b8b3149fce89c20019e70de07fc3129dfee35dd01936ab425c3f8ded9d5412aa659c20821b48cfcd7b2add251af41de2a89c94147d98de9bc0c1ccb80cbd2202b1c6134f36c3e4b953375f405541987c04c809cdf7ee42645f10ea02f193545ed8b73b48c74965083401a09dcd1c39366aa9f1bf520d19074199f3b842ce9acbc5b63eac8b383cbdfc68513ef3b05c701c2e86cd539b4332116c01d99cf3a1e6522814feb8f3e1066a63de6c482a684bf76dc7673ac775342fba58494fd3b33fe366e5aa6cd26f5893e0e7bb4a376d48a4f08dc1f23a589d9c4557a76fd7882a2ced9f588b2279bd7e9607525a16d1b0707f044237521a1a38a3a956153b99df64fd384b7ad51d3ad7fcabd86c8d1f53cf7fbad27a933ded0fffe77955338286c634e88bb1a4eef84a5d5652c01895fd0c1a73dde4200ce11dc356f876642e61a0a382af660c677d6bcbea9c5a14cee8895ff4e5a85c3dfc0a7236ea2b680a7c0e45a17e16a7650c8e9fd6bc15c1292e28f0e5e4ea88b852b6fd19d0564ef69963c707d236f51bf8a7b1caed916549e09c77be15398c07fa6efa07a5936dbd6c49826de086d7d9f394169ff4d988debb32e1a7621c0cf0d65e25c4195c9e10920bd140371978e7433353b10239edf7b3b4bce8799e568399706ea4c3e021e8f5b58007b4e8f92a6f627234eec26d7d62b28ac208ed5adf3b7dc087bfacc15800069726b24e51381e8b93dbe2a77af1e8117aaa7134c6ee2d415735cced695d0993ef1aef46edde30740f5ae55baaf20b773e05bc2d6a93655cbae36794dc09a497359236d05ce65fd82da17306a51f5c4f97d63581109ba940e7e560b0b8d922576bee0685481ec538be6eae23676804d7be1b2775403bc5816add25ef3d48c15ab0eba39910f4294566e0864361d97449c3f1f49bd8c8acafe2b5b8aa4810bcd1189af3fbf41c7c5728158bf00b8cb933d15469a9829ebc058c3b76389552e156a857d2428f6040b3a05b0d55f16beb426def5b02e1d97741cbd0de1169623b597ea0dc6f2afd8a259d29ae33e6c20940d7906c0999138ca7333b47ff253eabaf912153dca52bb201e11e98aa60b253e7f03fc084553885fef8a879094b52c46de225f1315a5464e0b8e6cabd5dc4fe7d7fe25f501b7fb129e14ef6753135a4be3885914393504e99159866f5af3e6fe4deb8d965e9ea00641398ec4317f3ca8403cfd8442d88894a2e4128464bf57c093198c6ae984024a175ddaedcb31b5c532019fea4f8fd2d3d3dcc6283fb52ca75383a4664777acca3fd158b4d080e3546a8ec33ce3fa794777c03783897876bb5166dc5474547043d62d90ac6f818ebb459d1c6146bb57769327f2b5f366ee07061f49c5d9d5914aca7900162aaa1aaf8fd9ca72ba72a56b1a4ce400651975edc9c206ed4c1e58884e6f24680b64be1a6a611483a72a7cfb7fff85c8365ea880687b468484031f06ab419e76fe3eb6bf9448315d781a46b87ab3ebd490e6be17f7804881a0f6c53547698d53d64d8763f35a8e8a45392f43b1a1dbccf8e792adf79d1186f3ae1d5d9e121204b198cc1e48ea855b9715d8aad487dc19708691f41048b73bed0c6f644688a57f9e7770c7d0a52c6940e2d8eb9af7101ed5d97f5eb7f22e25dd76117538fc2c08fddfc617810b7646f34c738f29cb63d6faf081aefe34ba44ddb5617bcefd63d08ddd48c43d563d29e6180479f9e5d3eb0d3c06e700ef5535b1a8ac2eec565382ab35e6298ea101ffd4a8afd45d642b326d1fb47329d16c5820935ceddd633a01f0b598843f4614fa0dffb82d9af45c69701a138dd4008c6bba84e1cb1e0943ac90f8f0e665cfe1a157a075a1d9a5e2f10cf15d01b8c5578cc02056af7c887bd936008581cf8522901122a63c1ff2404dc318d5a3bd407f89351c63a43b12eab9bf2f969abd90df6a347e5918f6a5adcb1c979e6d810e4c334ea1dddaa365120dc0c5c8af142cb3a1578188c6d75b8e3eda715a9f8547dd6e4f1474080532e26e6b6eac6d583520e3e1ff32344ab9ecb505c103569fe8276bc33d1f6ac280b1b5ac09549b8cb06180fd1faf1c7f16f818b1eb8151230dee10a108dfd1895a1ae1fbbe6b08b59c526ea69929ae8dc8635a5ea91019768e9dbcbfd9fa0a171b2028494e717a96c7d6e3fd062550515277828e8fcbd5e9eaf9fe071221252a3c465062788cacb8bbbdd1dde0e1f0fa0000000000000000000000000000000000000000000917263b"
	assert.Equal(t, expect_sig, hex.EncodeToString(signature))
}
*/

/*
 */
func TestSignVerifyZeroSeed(t *testing.T) {
	seed, err := hex.DecodeString("0000000000000000000000000000000000000000000000000000000000000000")
	if err != nil {
		panic(err)
	}
	var seed_copy [32]byte
	copy(seed_copy[:], seed[0:32])
	rnd, err := hex.DecodeString("0000000000000000000000000000000000000000000000000000000000000000")
	if err != nil {
		panic(err)
	}

	sk, pk := mldsa44.KeyGenInternal(seed_copy)
	message, err := hex.DecodeString("48656c6c6f20776f726c64")
	if err != nil {
		panic(err)
	}
	sig, err := sk.SignInternal(message, rnd)
	if err != nil {
		panic(err)
	}
	expected_sig := "8410f92ed3346a27bf692b88ea5bb99710aa01224579e1bdab35e0d438c379068b4aab692125acafe4fee066ce175e53eacab3c120f4b44bc2cb042d68ad1fe0c9cf9e93420805702e67c1979e8d4ded8f2020a43fcf93b1c12e163bd973ffac0f00c17a9fcb41b0809b447f31d19a544a8b9d969c2f8765f2797a347b9d0da21c25d66c132a5bbbbb1ce5c9e92d29dffcf2ffc158da339697488f95d1b80f1a66ba289ad18b632ae08cb814a33c09f7b3e207161920d6310bac16420e4657f44f0cc43f7357e884070c47e67437153210a1178d22d3fe3a8435edb49a6902a6985e99c35c18113ce323f9069ec4c03068081f173578751676bd3c1fd4ea842877a93173bcca03a264416192451b021a8aaa8832f25ca0971d2d48b5ce3f389a4619ffadb27e8c4a1eac0c06f1244300091d9e7ed3229418ba8c7131f8f03bc06065bf1f77dd5fd097abc0975b2710b275010f1209ba445a9e8d0cab46486b64163c3d5679611ef7ac0676d53ab531d356b32e06ad2bb401047aa78bb3554bc8bd699d95fe0537b5e31c1cadeb1b80bedd65e094183e3c9a2e35b236d1cfc1b614493a2b786320a22e1c61b33222ceda663153347a4ce88d242572431a37997810159a42d0ee7def0d75bdf947c96ce2119d01b8f267da604dfdb2d2f0742cafbbea39e7109ed268fdfd7607f04daf831a8dbb65c1737ca86c3899b38077802a96851272422c34dd1497ab049854b86f0dbc0b704b300fad81b20122f3fd0e45ffbbaf32684c71589948d86a4bf1273a9823806d8f332690411ee8e6026cf9836dd93991f43f6d41d5b8285d7455306decaeaddb1b33257276a89ac2dc80aa2a3e3d9964922ad178bfe6c3f05e73e88a9779fa1c66f1c866a73b10d7f65cd1961a20751a4f459087054ed0497df65be5f713f74a2c1e9b878d4928165556fe78cc76b4d776a5389874f75a705f106732a207be260325fc0054186dafed6d37f02c090bb00a81a5ea84bce13039aef62cf2653c2711cd726a4a99ca2429bc64b783ab51e37ac352730b830ccacdf74ce8f0baea2c4d403ecba9af2b0745ce30d8fd6c7cf038ff971b0515031e63ab56906f80ea4c9cfd33d8f3f644ce877004fd268a7280df6777863d0b80abeb7ee3ae1875b38f8000b877fd6924e5145ccf79dba48c4993ace889d570cfac0058503492f0681cf84e48eda6197fd46bf1158eb5b69044aa1fa2a949ea5cf213ecf551fa02973ca55281ac08945ee8984bcc05b759addbdf37333374b514af7836599f11269b0f6d1060dbb67388b752d568c51e43afef457608781a19e9a717f2104b071293716b0a9fba81c2c48449d92c7f60793540769a46c0fd7a5087f0dd1ec53185f37d139e53d57d2fca629e5885d15bfacd90b66fd7aeb607ccabb74a43aac251d2e79a10042ed1d5da8c14fecdeaad0fd03b9805fa695c6eabc1f24dc7ab73137c3e8010f65e0b341e415798a5d93fc01be94c2ec7e973e5762d7692977259ccfa3890989ba67ef866aea2354fd7085553020b5b09cb1cee670360c230592ba75cc4ce8161e4acb0290cb7207f8c6ae89e06475df99884b9e8013a3e387ddbfc1c8a637d7ebf7565c2ed26a2942471298eeb90af223ceb055cb0a5e5ea89369686b55ebd987550d04ea3d4863cdc5c3798cf7acfe4b420a528b49f511b6999701577b37ef84c919133323b8fda98dbdb435212a653cc957985b9b10d22fbc813640bf601e366bccb12365ca3a0341cf81fb9ca2beb8dea874effae2573127512acab7963f47806eed9421288646ae1ff4377ff604f6819a5447a79d366b01a74e95053c9a19b9709a78d578905ce540180130a853f2bd7235d8e150beb1151ac2eabc923dd3696b105861333bfced750ca8a61dccc6ae972863e9b77604b711eec507ff459d11cdc25b21099aa9f176eedd4a3a3fcd91fa989298dd4850e15ce8cf092410067b8bdf193f56193f7c71e3a20ef569432fdc6154175d366dfea2e1c50268db83a134ffe43fad15b17c0faf24719d206bfbd182ea982ab8a62c59f8b663d165a42b241df2a13d75059cc60ec18791b1b2ccd7c7be7448f94cbd444f3bc515800874fdbd47925c74d1fb711a751a6dbb828b5b70b4f3e3f4639500bb37756d8cf2f8b0f2791c4cf887f72e2c8d63f127871b4b9115f30dabb413b89c83d3a17d65a4e18a89b64e67bff27176946fba4ffd3e83dbefb9336a5e81a83690a782179775e9665624f779e01ab1b0b03c71bba95195f00e63362eacb2b65cb7f7a68da036828272ef09dfca372d0d0ffa25074fc8431a8799f259ad744d5cf3833c376cf7e8ade8965f430bb5cec53c18c74b32f491e466940a16979c1daa300a0ce53222ad13056c4ece29954aced5666848c90cabf1a4b939b7f051b8506465ccd1cf8b7501c169888d72e95fe75b3883f28c22f6eea3d4023ee8d0769849edb8bb3e8c87e978f68c60f8c595b32f6581357775f1590403bde00e809705baa48f6916bfdf30038da78fff290f3ac19daab405df665308433ede0e64004facc040867f7f0a12b59e77d2870d53321310ee39a2b36be09550a1e65c7966dbb064b5164062b2f7e535d09d3de269a688956266432a9af836eb0c12630f632c0add19df94b6ce18c266e1e7337faa51e21ab7f461327dd4c964a05003c220767f67c71e471a7dfef13023ef45380896e5ca84fd51c8d3b3e850aed8c89a9be7677a4c4b493be4bc4fa577d1887ee00c189da689f1c8548a281c0bb66493469b3235bedab6951afa881708bac1c8b6a89c53816a7d24b9b62fc6952ae634c0a36101b5cda491112f4b955bbb3bd33c76eaaddd9ac645139079da1bfbca6f320b4a352963c03db0a6dc9fbe8edb584904fdc0ac09a4499e7ebb044583836d6726a49b551f67e052e33ecbe1004ca30528468362a3e4bc6445fb7b84eda022ed17b35d8e9c2f811d575f5705c6c4869cee76bce1bb9e3d8750d9e3aeb2b7af31f2218ef3ccb6c2aa6a30a46f3569c36af5239baae3a119365ca056ae3b5916a7493dfb489f1b7dc1cf0fa2e928d5244684acadc3495c55f48ea5cb950dd3f38beb4e95e8d3f6fdc09a8f2cf683b9eefdaa29378a74df1e4ba4fffdfe04b29379f606d06e7daeca481e8c3a30a776f6b23eb581857bb2b34e656adbed18eea69265825993e473903903e2c537680fb3058046097d349a3727843c8b503e8be111c5a87067e98000d7fb953274677769619ae996c8c16e455ee4032dd6ce4c8bcece3f1f2330416df83474d2bbc7e9c0c2d3641888995a6acb9bbbcd0e717284e575e6c76818289cdfa0d3d4a9397a0a3a9afb4e2ebeff00910131c263c3e49596a6f7b80b0cde2e6e7ee0000000000000000000000000000000000000000000e1a283b"
	assert.Equal(t, expected_sig, hex.EncodeToString(sig))
	assert.True(t, pk.VerifyInternal(message, sig))
}
