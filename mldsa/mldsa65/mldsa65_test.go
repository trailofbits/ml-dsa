package mldsa65_test

import (
	"encoding/hex"
	"fmt"
	"testing"

	"github.com/stretchr/testify/assert"
	"trailofbits.com/ml-dsa/mldsa/mldsa65"
)

func TestKeyGenZeroSeed(t *testing.T) {
	seed, err := hex.DecodeString("0000000000000000000000000000000000000000000000000000000000000000")
	if err != nil {
		panic(err)
	}
	var seed_copy [32]byte
	copy(seed_copy[:], seed[0:32])
	sk, vk := mldsa65.KeyGenInternal(seed_copy)
	expected_vk := "424b2f267e58d5b3b44d71acfc6a656bb26950d57c61db1c880bcfa1feab443f0942ab8bdbad7d708abbc356078f6d99a252271fe62c74091eb94afb9b9264c50a888e0dfed80cd5fb2cbd3667e60d539ebe44930219cd4faed15dbb3455a264802b9f49bce42ee7550feffdd4642a55ade693868a460cbec03f4fc99a4e30bccffa8a475e5395396674ebb81a94937587880f6dbd27bf1c4f5a9ee43cdd8b0e53b3b7fb49c73adfbc2d4f8c54303520c29bf97e26ee57db342d957c893936522d0942b41d82ee3772a00570adfb545c1143922b0496f826a0a970064b36ddf534b5f8e1c1cd0b5565ea846b45431f0618143ece89777bb3f61179ad20295fe0a6e062ae6eecbc2ef38f2ac1a22dc93b7b126336223c55b61eb8c0795542bbb2dc65e722eadc6866ffa9683beb8a999ad7a83e5e6e016c2e4c35f6f7649ad3bd52ec67ec1c5c6e7b9972771218be9554bba7727f0b84c44b9b0a8bd831fcff2c9779ccd4ca30c6ad75b04983e41de893ee5f39ea7355180b709c7045c22d33a083f6ae07a114746d1bfdccbee5b9043879bb5a2e120e2a4636283f4a1cd4924a2de6a4aa3d99ddd88f48aaa4e88bfd1ea769d82c10779f2ded796db542971ca289b76863ede5997b7e9ce183b43ccec278b10d92b87442ce0435bb1625171db5554b470239c50d2a0c3a41b2a38807db070b47bfb3e7d10f3cd979d69963c8d79f8029cc4a48eb04fcb3d708844febaa8b6ddff01ab64d59358e6505c4ec1d7cbb14ed2212df458ecefc03fe03037b1505a4c9444322f5f98dfa91a4cb8c45860a2dadc7515350bb6d431e49a6bc8f5ba956e682b0e513321a97d1962602891c9078f62a8a9646a31387a6f09684264837899e0d8ec7d11c565901298b20b345081690eb4c562c1aa3a25bef06566cb34c79bc0b25e4095d6ba793e81311e41a3329152686f00d4897f84fc4edf4b26d545365785ead8d63aef64a87c0b91a2e5500383956cdf5f6e37cf9d5482d1c8e3a5be38f17259ac45c9fa1c4bd3bf177d312ee52a6da023c05722a8738274dda8d1b04e99831cf57c87282a256c565c296d0524a063a3a41a48a83009978d98d8abf61af68e8013b594fe151d9bec199902c4c70b49584201743c6b53103d2fd24bdf078dc90b5a188b4f8d772179988d0416c94d4c57c0860b9d7b53d4cd261f332a1851565d52ac37f008747cafe320f363d9beb6e4117db43fd8aeebe5e0ce2f54e3f0367eb3cc971bbe0c301a8e52f96094936035c6ee3ca2d13db483a0dd04dc16247de0e0894ad7cb7e1ae7ebd4f8f900582b20021e77f70254501c6ac3dd15d43bbb7931c5283244312158c2eb1b3e1117e194f0a1e4c783efbc62c9f81c21562d0d34a5f042b5eaaf32f31f95c5b055f4e7a2070fb096f56c415549cde74f3864e8b9fc27e3299724b4639986044b55928fd6972785b280c25a3e21aab814ecbfb0c3cbec0914907ec907f25a1d88bce3d319ae8222a35945db62af7cc75cd29c1f5d98fcb93f750dc3031076979bb51dfc37d23e8eea78073a24d3e26c68e7bb10e459f2577b90080359ae0aec10318dcd9e0f9e34029c31b3e54b1855645db420618783346dad5b55eddb4f977b326a655525ebe2195eca9cec38a3c0d2273b77d3e68f1901c2ca5149734a51177bcb089476b18cba09fa8b9b46d94a2946f358e1decb1998652c58a90852423e2c85e79d19724461627e6390d1a81fb1a72f9c7edc4bd747dd5c85217b5856141028414ddbe71458f0a0b2b589df2e1b051783b8f718676b1defbae98ba496c2a935e92eeadea0a8393ef59f9e914f0743fe65640ddf9981cea6dbdd957a534ad4e790efc974ee89938ad99d53c5b680775399326834729bb37b082e795f8d87f52e6c8a8db68e515c277bbea82a7570d4280896c987a0608903e306c632a223c55f0ea3682039c4a3f5440f4b5ac3e6ed2b2dc900cecc72b72f50e49b2629ad30f0487b2707b86286f8c4f55659b25f9bdd7a6af460cc3c57a3982663bb717461581e196894929d84153d87a7f482d284b5b894ce1a78216b2a011f2b88742cee52d5133e8fe77edae242f5af91637c37ffca32430509b2fe4756303a9a3659fe32528af1e10d8d43bea991b2d109786cc66d35b1d78df254b92cdaa40f91a987e4a922ca81050e5bc3530ca85493bdf2a825374d0a8310a6860284ec3ec732326eeeffc42bbd42bc91b73e5e7c6b599d016490637629f3876c3e42f8db590e66a85a7838c818f78fffb4853cbef09434989803545dca87657cf7c7e7e6afa71382bc10fa0bb6480f243eea1b861101006fa0cff3275621943cc58eb4dc3a0428a5e425670fe82268de71c511d8ffbdc11b0d0f961120e971015ad5f448886b802e3fac11672319d487c84f1001339cb969784cb57344f2807f8b425f1d73caf8496d742ed237f4c9fcd5a4e84fba7e27fb1a8ae12c4f0427ae24e910d951bd8c35d61f8a678db01caea8ef789a95b62ee1b8c5d32c6baa536ba88a1070ea61aabbf59294e3f6f974c4c91cafc5bbf6b7ecfd57a18fb7557d71e06e900d281b0b49aa00feabb35714af33870edd7ac2393d93177f79ee5606c9df176f025ce49a6e5ff51a2a412ebf86ac0f40471c96ad4c119df230be6173df530ed656cbd8069214741ecdd0271c603fb6c4a8614ff878d33e726cac6693e938ca3fba82c4995c14a2d4af9014fe4c4c50b794cac596b52189f66a7106fb325b526ea"
	actual_vk := hex.EncodeToString(vk.Bytes())
	if expected_vk != actual_vk {
		len := len(expected_vk)
		for i := 0; i < len; i += 64 {
			stop := i + 64
			left := expected_vk[i:stop]
			right := actual_vk[i:stop]
			if left != right {
				fmt.Printf("\t%d\t%s\t%s\n", i, left, right)
			}
		}
		return
	}
	assert.Equal(t, expected_vk, actual_vk)
	expected_sk := "424b2f267e58d5b3b44d71acfc6a656bb26950d57c61db1c880bcfa1feab443f4af658e8ad972c1b58addaabe70b4da655418762e51a98accf5fb3c95e1c4556119c7cbe3b3b489f2f542238e836be44eb550218e55ef7e4f570ae8752aa4624fb7028640eb0de963eb329eea67a58d88ece6a0c515981acfa69fe5862cc0d4f546403343535630445856422568504463222630402802720252288764443472023118687680533557475471310146485423088262740325147084748747116076846672177145860847866781145887652553104346046058348023417345468611132212161606387747368783704704812532042120238410614552378205853532705520378038717814308335215657517816038654658124645440730844317788120188282312285587862806462551088480272704407652018468173715272114461307780044273707078510780455245316370045784151542562356224276343701877384630488528455725124274530362453588221388727260662835785012175335656432571742153051033372850362668825478333233323261824423340735461386174053080200383457114116822341781752074380857571674501004410357587481378406328281844508131511862787252215172886114043011616171177477173585078068811400307265651380726635452311571517675875518522478206275800311116214452018602078158653846484286452448573221356236574074700646120576008742005078601413088565171145540815150487838142826121331583511875302014466016725822052787302352733411333077387204503031208072173754053754757563774187683178258152720516687801644657083360202670021387656656408530617252852382432061680443576841863028286015200057011608731805613358614331026803724856018723718676571600078823801644233410036736671311506701813210313375162021200732877282447052861486414768514871320501008067111216172674782622517178875677638820057151608170230255351552848214548556758356147301011523800523372401534612502538072364468532005125346432408667074576458687011635541742586208007065811658712688711847521182233003255780370561212436048047382576035118846368420284754440737185638483852376621883412703630332243682278751720777530875830772714670254228616813851278288433287730340886458230520423372120108081164641676743815843061458271727824764537800667507676687742817841054481701762547118625331236011471405823247774401448364085111621051040755148418163124305518232876045774502583760781803528465520121610505517176777733647628051454174547543206540780130132325802276260063037171773444657264683231844773223811386135340582675412070578580555376364815221814842376180463123353083367881628762135387551383605314428721032661052575712545722444161126742213374732747678843116604077672513630623560440507538881884307727744527545006045186677408184370843447288273672342731445582680101241222556220112746278784601625861107425172711253630575047867474817836083422200018246242770021285066475414168532473623325264637315386560682038801352343817072137475338663857124230648456762888122524102654188145137211467567786146034330321352677288008114285171074410252110114501727472837332260181215343083725458120885047202558038671371017380622158742655318772351505342234340773266016084064720717333285278560746540733283511380815747303774723500567035415686661263035421843222888221277838433187503761445535414157118057307023854047106064046880651036157633538652547131620623844885831b321be8835d583b46a9db84543bd8c3abce4b6c039ea1d39833c93006d51d935fbba87bc46e0342ee15be40f572c431b99c74f250876814ed9a4e3e532ccde90c2668cf2b3a6e3100c592367c52a93f687ee23084f5abffc1e54fa5a7da2c023f5db88b86a6bf6a05e6c423b8c74555a50c2b7f32609a5b786d835a90c2b44d4d2598a7b1d6602d4f47e2b9fb9ac53c161e24d0da27856ae04a63a10dd36eb537e77b026eb96a452f90dff0e121284e7e98863e36748784ccb68271defdf0a5ca51fd0a180bb11e5c1ce5a1c7d5ae420a848ee66ff4c32352c3f1fd24405b910c277496d2b3562d5f185c5474559d0f05ded476a5753fcabaa804b600aa0e60059e16fb610635c5590dfeb8734d11f583236c869404eec6ad13dcc395194f664efd7b14ed08359e3588b5f0ef3a4697d13c99ff3bca0d982b9c6bcf61050ecebec3cd48bdf6f61bcf0090c082f6352793506fabb092c9d1f13133de54ac632e41fb2151f5dcdc48328aa670ca3da3afa6b16bdfc86f79d71f9ce3d8e1de6aa1b3117fe3219acabc176b71dba117de1bf9a1f022a5c425fecc963a3f32df4d5918dcf449389ff6b42a3cacee636097b93c94f36239e6b4ffad73568105e834cfe573effd98cdcc278d9228718c865a3ff5440a4cb27fdd13de1d6df8d3d19282a42373439b0f54934bacb861cc400929ffb879d837172200a0a3bbab9c5960e228fb76c1a3259c779a85d8f6a17550063feb727a19c383cea7bd3ea74baf74632b1438b43b8ea504658b073d460c14a7998bc2dd62569b157f9b1a4fefb3b454bea3fb562ae9b11f9970c7c54b255ded7918527b788e82517be061456b483ce9a0caddc0f3955f42dc14beaeb36745ffd4f17b55be071dfa6dc7c298a28db76147ce9452e84cac2bf00a148db30471a0b72a4c105a6c9fb19e3a5aca47ff7147dbb8ceb73dbf8bcaff2482d8adf44d0151dbb746cdfa249940942736657a54195a9971a53a54a02e000bd4f15207689b61c70ad075a393205135fb7e7d888512824c1825ea6f65d797dc9b763cf97f409e0f0a0994d685a47dac7c12843eec82d7ef5a055cf633b13be0b1821428b3f000e5c4965fce9dde3b5e0ced90402a6b8dc9f8cbdb3d6b114e0bb7227ce84f1ef003aba69dbc21998504d28a874536e961d8e1b732159fb83ee57998ced117d369b7f226a368ac880847643aaa6f3aa4338b58e666e5d639d61abdb27049f46ef09065569c18cb6c342bc06ecdbf90146accd3818a6cee31a0ef611b839932a7cc1b9a2884d25ef6a6e75104de837caed5898db5ab3715bc80efbe74d1273fa921b05c33f17111cfe911ff652bdfc07e568e93145516e9f8cd023c5a312ed2c55bbc92f7875008a4f7b3fe4956d7e7050b4f74ed83436259627cf7fc3442b21f19d0166db0b9a44e50da4f7420e78181e3240539c8db71b63d24c2fc56359078f615fc2d82c4e94df59cd77d11c4a6027f8e363d6165cb042220133331a39fcb271b47bce4bc0de5b9b95c3edd6260db82b9a14fc6f3202b15881b868a54e6cce511373f7297116942ce0e8d5d7eced81c76311d39a40687bab6680cfde6827ea5b45311ac9074aed557ca5c13c90adbd9b2765453d577a06849ac43fbf766a3a9d2820e85277ae39456d3e6002c6d9f3d09490c9b5aabe86b0f7126301544ce32dc619a83f866ef202e4a6020a2e83eb7defd2615fc8b0af2fd65329c39b83b8e2bf0623ab8258c4bf03a72f6d82da134e4ebcf79ce97046031c3c2f30a127edabca19950e97070360500825cb69405b58a44b73fa252c17b2eb3f311f8c2cdc374c316f89f979d49423eb3d126c9432531cec8b6b3c625b2d3a09d93b0df6c4833753b28b40a3e153b5af98863464351a84aab0b1d5db230cedec2262c809d2bfd4a2fa9137287d23ec7d4e38a3cd83ae5d41239a89c2817b2da3a5becc5bb73b3812fcfa557b233ac2b39a7cc49cb0ec402a1f9e6d81876b7efdd7b027178095a489a2290874419d9b141f42770f41ed1685a107a4b0346ae445b355c6849a179931f1422eec53dff50fab62d86d9cc4f849c76f847d43127805afeb90739f60eff58de73db2ebed94502ae32b044ad3a9878e8f66a6bfcb2ad037461d3b218dcb79989b853d0ce470e0c29a29585032ba98e5b8696407d083829912f8c048c24d666454861a9140b638d362e942c3a16eb6bfc71d19574ca898917d8688df5ac0f0ef4467f2fc77666445ba7a7f595b9111ca8ac4241c5432f429af0d81ff2e276d99547542673ef63a5e3a847016325dfc98a45fea17f09390ca394a7f98dcde3ac1dc9b71848cf814a3188210bb6a3f05805d76c881c039376f34abe6c706baba3dd5d2eb0336cc61689648914cbab04f9d250b53fdc8eddd2efca471e1e752b15be631d107186cca0d83140f73f41c2457c3d30ccd9b4555a95fc6b3811290cb6ca774ed91d7d70bdbcdda86e92ea27ed883db62aff62cd86ef7138ffdb85cd13d521a96653be13f7d0a064eeb77ee4d93b5dc6bf58302fe706357ca46f755d28966d466fe3d1bf10c34fe8df0de8abde2bc3206487d57c2ac413773bf46c1edba6f6b09be9b8af647c5c9b4630e60770c38bc408fd93cf36b826699d9daf1384cbfe369c7347ed5f2c000a234a720cd0fdd28ec91e8b901a1b7f821e33bbb36142ff6d7e14dbee6ebd63c49af0549637e7d834b2c62dbfe120e6439cb60ae38d375fb3ccdc4e9c844f53eb31bfcad939b47a05efe35479b1d734121ef5734690e00790831e76bac9531e8cdf75cc8acf45c3e44e175fc6e17aa62e3552ebf81b9664b7af278031de8f304864f764e4d3758219c528752bd507ed1f688a541dc36a8ef8596e0ff9c6cc08dce9de1c7fc0711d5f90df38cd2e7ccb568dcfd7e2884c2ccb0758b6397a57f236606606205a137ed2befd60e0963e6cbba37b7d937b7d0620d94e5b70d13baef89653de007f176af065903b0c9ea9b459a0bb239f4051758a0604cbab7583774facb574b7abe6329c6509155cffcda6a2897e9a89bde9d91186c1984cea46e5aae6b708bdadc22772378de53bab93d870ba8f0f832563305af7e34bcb87041745e6d3037d1bad4faed00ecad201dede7ba49663779ab60940d92ac04e4fc0740cd693ec323eb5a270e0daea8460e98ec5e57541b829506bb45179e697ea4892f2e782cd1aa34e7497fb2007884461cdbcc7dea58a80d985ca5de3195aa827a0de7b0489527d1e61613108dbab27ddd7a38d1734bfe5cc8b13ba417201f5f15cb8e5bd54daab82108a95404c58ee2546df6973964c1731bcf86cb9be573e9be10436bfa374e09e1e67f495b5dd53a41ac61c84c72500c5216bac28bc3a399a04a7b8e7d636779d0f15903d139fa10a487d561e7b4bd0b38996bef42c04519ee3641e8485853e3046973f63e43aaa80b0a85a191cb016fa1accf36800419060d696ab745f23ed8053f0e6dca01e6076a62b24253e77bb5339edcee4de0a53f37e9ca0"
	actual_sk := sk.ExpandedBytesForTesting()
	assert.Equal(t, expected_sk, hex.EncodeToString(actual_sk))
}

func TestSignVerifyRandomKeypair(t *testing.T) {
	sk, pk, err := mldsa65.GenerateKeyPair()
	if err != nil {
		panic(err)
	}
	message, err := hex.DecodeString("48656c6c6f20776f726c64")
	if err != nil {
		panic(err)
	}
	ctx := []byte{}
	sig, err := sk.Sign(message, ctx)
	if err != nil {
		panic(err)
	}
	assert.True(t, pk.Verify(message, ctx, sig))
}

func TestSignVerifyZeroSeed(t *testing.T) {
	seed, err := hex.DecodeString("0000000000000000000000000000000000000000000000000000000000000000")
	if err != nil {
		panic(err)
	}
	var seed_copy [32]byte
	copy(seed_copy[:], seed[0:32])
	rnd, err := hex.DecodeString("0000000000000000000000000000000000000000000000000000000000000000")
	if err != nil {
		panic(err)
	}

	sk, pk := mldsa65.KeyGenInternal(seed_copy)
	message, err := hex.DecodeString("48656c6c6f20776f726c64")
	if err != nil {
		panic(err)
	}
	sig, err := sk.SignInternal(message, rnd)
	if err != nil {
		panic(err)
	}
	expected_sig := "32e52969517f3ba80d63a2aeafeb0198ad84a435c32f36a6021c0c72577d3b558c21fd95b386d17e9a6eee5fc01036c445a1d0236aef8bd805ff0881966b648c6c95f35c2f6bacf86c4faebfd0e53bf1eb838d0d47b5f71874ca2f4483d89a9a3a5b5e94bb2f5fcd9a29061a05b11bee89323a4cc12147e1dbd57801bf4b4e8a696b7c39ebb93f27a0fa979e0035bef5cc34f3aa1fed8ceb53c327959aee189c52ab37740ff049709e53d15b8853e33d56540f50286d003a9c6899c001e36e40cedfc35d3bc695bdb79ff450cbb86843049b33b69c8d151373fe4c585c86fb75bbef10a1e1fe54511290823328ac11a73884e55e0aaa9b8b275d5e165197583b222218c498dadfd1a88e2f02ca40888d0787c00fa88f4b691d001807468296278cdba32ab91eeae82e7c879b8acf6d907b324444e9f4da64c2a64f7fa78d8874db9c52ec1ce4e444585428bea3b12d54c3ab8a2f33b10f8ec3a421cc0b053ba61d3c40eb031d1980a85283c1eba63a22499558fd86f9b3d1a282445d0095587a2027b8682b75725055a3cf914ffba14464cd94fcc7f591724ac3dfe2e0674895c15dce2f9f607e50809fadc61097a3c55a25501fbb011492f3e096c8c3c7cfc3b1d8a790791288e2d5520ab0051d0eb900190cb4837a0506e0263dac18d1efb637c2153a866a2e2add03b782e4f91703d84b5b9a743f1cb0dc476dbf4c8c8ef5ce869a62eddf79b7bba0a7bbb7192e5a27a851d7a7c4265f340d216677d7629225beec731859806359cbf177c6435d8f29756587f96c49e1f4fc6d7bbfaf625526ebf35e9205854c766529b74b167e638713a326ac509d43d47219f0adab742966a1c0b5e8cf4d5c5ad62efa6d33350e15cfbca676ff18a49feb3fe89b4ebff5a78d11ae3d8f9ebdb4ffa2953fbf06f9a1c2fecab2c599cea9e36dc9d53106cf390e8132fc98799e6039fe5883411f39ad960179351b4a04731bcdc73bb53a1b36a62f37010f5805ff951ff5f03206e25fbb36ade96f80d0d19510dabee8cbdab2a5b30e86de97e4d9f9c3c3df8b1d2c5c8c57e880283b24e8f6bcbcee59f20190647626478baed16625e75d0384ff7f4a8eb3f9ccab49c8f915d7ee861158380d1ef2c72f0b9a3c7a00576e95d871d09e31258f7638645e7df3446ce56d0e3ff7aef4dd392ee061342c4126cd864473405f314030e55cc5a6c44af6093464fe9f4d78e22daaa323ea95d286a7a49c9eacb31be5604346601f8d098dbd046a0b1aa09bc2b2929d75a55bbe61c9a5accc9d29e38445ed50e380a4c3c1bee6a205720b1a55cf5eac26139707afe2ae0f27f9353563a57e4fd6385b055a0b3f57b7d864f2eb65b548b3a3f8a4d067e2ee6af05112f184ea8cde00dcb67225c51be53c94a9f231ea21de89463236cfb9452185c37d5af4e3c498144bff96bf0cd1713fa0e90cd1d8280665666f81c49b33ce34180a1e5d3b94069b28026d20b34adfde87530834ed27071f0f608799fb559826a37a12293f375f57bc4eed599070fc6448850ad3f61fe2a3a1410b68b06b0128cfa2c1619c199032738b03a2bcbee94a0d92cbd34f847fab724261bed1df882ca45ae37e7057389b725d6bb6e8ca5e81d873c32647eb684d559c6e464a5758bee86332adcb00a53840011c48ea1b1cbe7814dbca542c5fe954505dff0ca8254232ed2a143fb8509ecf3ed445a792f9ec112973c4b51f8cb6d0d9ba225490d222dcd9636aa7c09d983e3327eab4a3511f93db3f5785c1eac1155feddb109e4381972fe4aa9c0f808d945bef4c853f9bba50346e76764acd613a309eba7738df7d364055b21cf158d2fdc9b10fe8f0f442a0fc827008ce53324bf1472082a9ae0bc9ac5d06f01308a9a20ad0b8899972a207e56db9eed4e49571e88b3acbc4de6cf5c602571059968d89765114cd047d916d8189aeddae3cfb053cbfaa9cce72bd991c7a949d2621b3d812ae3949a21afd5d4ecd63b0713efd0468cb7651ad2c27f64d81a99e43099cb7df4bf55d09b9d44d48186ae770d3573de801e514843b1e876a8e42e5a1962dcab498bd5934cb3654742b01ca26adfa2e93a86b06994d70cc99e7ac25d0f84cc6d996cc6ff669ff706820e896999f45870ff900444cfcb0e9d767b2ff3def9d75642d6c62f446c242404a7b437a34c74b879d244eba0ed28aeb979d64af3fdaba0e863e2f78e74435eea0f14b7f9bbfe838ec4a4f28ab26812f45ba4646c11240e049bab5e582da592ad14d40608e0e0e6a98987d08d6708ab46cba67a7060b91bf6f9741cbccdc59eaf3c5cafffe5f0d610a85d231dc306323e82d6e05a4f38f6fbb8240d1e72324294c0844970df76cac6a1ec0ff9f16c72ba4f47076ec8914b22ba9494d12c44cddb43795ca20a8671774077a85551b4a0a06c5c40a047b11be4f9a2bcd69fb2bfd86aedea6eaede8eb76a03ed4cb66e5c05fd5c3b95e80eb361cc33024ab996e001375e532a229875ee060e29f86fef6c79362733901398a031982d0f9b3953fd97f952b9632e5a13754d5705daff5bf01e5f20b7857abc64b1a1bcd7fa327b1506a4af4c85cafe71a30919ed6df4708e3a9f5aed93fa62e94c9b97b19508071ecb9caedefddf414dfe7a684b09882b01638eabf16ba93d4829ac8c180cc965b2d33e288250c550751bd59ce3cce47e1d32eabec8b86f264a6149068f02b4c44c291e3d4458e51930fee19513bbd4d58ee73848539ee7e7110cb371e0073d4621c32b09f3cc6669a4d9b2518a6e0b37c29267bbc908f2060d2781cc3841c1df2d5ba7043a955c3d7581d656d4f362b1bd7753d543ae36ee397e0a512aab5e0055aa91fec4927f0d55b4a2c195ee4c207e70575d027caef65677e310277d801db2af5d2ec0ab53b900c1d7fca0dd588455482b741d63bf11c006a87f4163b3f8a193230b74f1bce651ca732e3489a578b7fccf7f3555edc2036008107f805d0f046f42977e7f72a9196414ad3307670d50734f8dc81a40d79370e4aa99a3e2f211da615c048f03cd32d4874e421c5e6440c17c78d33ea2c059ede69bb719b345b0ee1a59d92086dd62d9f0bbf8b7947b3739d72077937ebde3830e52794d2f7300c6a73efedac2cf8cd4495f71799f480b0d6f021418c6bae02eaad6c13eea5a995b6b68cec84bf5c516e275961fd76ac5ea2415cb40714db3d6832f2323c39703eb059ab275afeb1cc24f7cc7726bde441cf869077fdbf05ab8003f1654e5e109431b81a52d31ffbe9e9b64c5979b0b773045b1d374bbad894d058442f68b4d7322ac76be35c12f2a61826f31de2fe4be0f32738c2d25f3eb7893f839c87705380c0a4e5dc19828474bcb522b4a3ac73b09c0dc2074dde08ba7d64e97ffb81d96966647470b19d102e4e5ad47a7db5bfa1612391df9f5a0bdf5178e103eca2e36aedc80d1ba0244b0f7b338770ebe7bd8ccec48c8caf2356336a3f5d9e759f745d739b74aa9882ad60c840a6aae2f170a2cdf6a0954c70657c088fbc40082422138788ea0284ffacc4fbcc2c24ebe2e0f426750f1334a832e5f1156b772c2c080576bac73f67662c1a5c258409476219e39fba9e29dcce6721c527cfc201a70ce5083b25b3858e2c03abc1299d887654c806eac624c075c92674f6960c1a9010a3fc11c650ea8d52245d7dec6ebe35a25e16468b2d9ca98952158f03f06cb3fb9608662194fdfd2f47b26342d56ed046e7295b74b93a3b52e1fb2f885fbdc05688e408ebeeb7e96ecf87d9a57d4fae97befc840c18fa5f198ecb7d6f5e523ba78cf43dc6a4ef6be2d3ec3762059905d4e55c70855a6d3f3b423daf62bedb45173bb39ed5008b53a8613b4eee8fe20084fc5f94a4bede259c4da6af444d4a6161c9419f364e7e83331c5ea4f48f2ec116a339941c1c2841e98e4c7c23e105422e735c86a4090d2cea9434876bb84d3644bde2aecec49e85261b77fa56c419ce0fc9b84876e0f22bd3fc718a78330f8566ebf885beeccb2f1b5bcd2ac4f612f0e115a73175bdee150967a206dbd13704b5a0e3032c451af0735639bdc4aa7bcf20c63a1181789989a42d150b1f2fbf7e20f2f17a85a274ef4d222e6ede36aa65fbbdd0e39d9ca105a6a1c1c8e7a86fd6626037f2473fd37026841b918c2e04bbb6c26deb9cbdf758df5d9da2ca229426cefab8fce6b2f15cd0fe42aa849e203b4ee7f33ed0b708aaddb157fadaaf5aadec856607fa4a7659a568be85c59f568f3afd7d8ea59234dfe5972c7eac4428e15e8952c48b324551bfa8c17a3e1fb27d323eb6c8f93e90bbe7c327b65d55f72771d922683fcf8fb562d7e2a92aa9427219ca2445fde0fe97ae0803d60fddbb77c7ff98acc83b1904d2a62334292decbcfaf75e87435b0290afc7b5eba9bdf9a68aad611b79d2af58ae2208bc1a31bc50671dfb68531abc0184a7ba772c845c945ca7d748e3975b96daae0f6ce084ae3742da997132d2f06430e9c5ec3eaefb56a47cf820ad28ac24b0054923e7b3457b23fedfc275129eeeac007da35ee4e411627c4716b51652886d332fd4e2e24d98f1a0e50fdd22ee4e3ea690c8fc65b20b3852babed7141d209498a0a5acb6bbc2f40e1a3f42a7f1686d8fe04850516c969aa4c6e04b919aa7ff000000000000000000000000000612181c252a"
	assert.Equal(t, expected_sig, hex.EncodeToString(sig))
	assert.True(t, pk.VerifyInternal(message, sig))
	sig[0] ^= 0xff
	assert.False(t, pk.VerifyInternal(message, sig))
}
